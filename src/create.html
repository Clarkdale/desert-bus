<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <title>Desert Bus</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
  </head>
  <body>
    <img src="../images/logo.png" alt="logo " class="logo">
    <form onsubmit="create(); return false;">
      <input type="text" placeholder="Username" id="user" required>
      <input type="text" placeholder="Email" id="email" required>
      <input type="password" placeholder="Password" id="first" required>
      <input type="password" placeholder="Confirm Password" id="second" required>
      <input type="submit" value="Create Account">
    </form>
    <div id="message" class="error"></div>
    <script>
      function create() {
        var pass1 = document.getElementById("first");
        var pass2 = document.getElementById("second");
        if (pass1.value === pass2.value) {
          var url = "controller.php?n=makeUser";
          url += "&user=" + document.getElementById("user").value;
          url += "&email=" + document.getElementById('email').value;
          url += "&pass=" + pass1.value;
          var ajax = new XMLHttpRequest();
          ajax.open("GET", url, true);
          ajax.send();
          ajax.onreadystatechange = function() {
            if (ajax.readyState == 4 && ajax.status == 200) {
              if (ajax.responseText == "Username taken"
                  || ajax.responseText == "Email already in use") {
                var message = document.getElementById("message");
                message.innerText = "";
                message.innerText = ajax.responseText;
              } else {
                window.location.href = "canvas.html";
              }
            }
          }
        } else {
          var message = document.getElementById("message");
          message.innerText = "";
          message.innerText = "The passwords input do not match";
        }
      }
    </script>
  </body>
</html>
